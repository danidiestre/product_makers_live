name: Discord Notifications

on:
  push:
    branches:
      - main
  deployment_status:

jobs:
  notify-push:
    if: github.event_name == 'push'
    runs-on: ubuntu-latest
    steps:
      - name: Discord Notification for Push
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        with:
          args: |
            ğŸš€ **Nuevo commit pusheado a main!**
            
            ğŸ“ Commit: ${{ github.event.head_commit.message }}
            ğŸ‘©â€ğŸ’» Autor: ${{ github.event.head_commit.author.name }}
            ğŸ”— Ver cambios: ${{ github.event.head_commit.url }}
            
            â³ El deploy en Vercel comenzarÃ¡ automÃ¡ticamente...

  notify-deploy:
    if: github.event_name == 'deployment_status'
    runs-on: ubuntu-latest
    steps:
      - name: Discord Notification for Deploy
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        with:
          args: |
            ${{ github.event.deployment_status.state == 'success' && 'âœ… **Â¡Deploy completado con Ã©xito!**' || 'âŒ **El deploy ha fallado**' }}
            
            ğŸŒ Ver en producciÃ³n: https://product-makers-live.vercel.app
            â±ï¸ Estado: ${{ github.event.deployment_status.description }} 